# Configuração do servidor Nginx para o Frontend React
server {
    # O Nginx vai ouvir na porta 80 (que expomos no Dockerfile)
    listen 80;

    # Define a raiz (root) para os arquivos estáticos
    # Este é o local para onde copiamos os arquivos do 'npm run build'
    root /usr/share/nginx/html;

    # Tenta servir os arquivos estáticos primeiro
    index index.html index.htm;

    # --- A "Mágica" do React Router ---
    # Esta parte é crucial para Single Page Applications (SPAs)
    # Se uma URL como /dashboard/analysis/1 for requisitada, o Nginx
    # não encontrará um arquivo 'analysis/1'. Esta regra intercepta o erro (404)
    # e, em vez disso, serve o 'index.html' principal.
    # O React Router (dentro do index.html) então lida com a rota.
    location / {
        try_files $uri $uri/ /index.html;
    }

    # (Opcional) Configuração para comprimir arquivos (melhora performance)
    gzip on;
    gzip_vary on;
    gzip_proxied any;
    gzip_comp_level 6;
    gzip_types text/plain text/css text/xml application/json application/javascript application/xml+rss application/atom+xml image/svg+xml;
}